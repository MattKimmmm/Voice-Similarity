nohup: ignoring input
Device: cuda
Loaded data/processed/train_agg_2_b.pkl
Train Dataset length: 13860
Loaded data/processed/test_agg_2_b.pkl
Test Dataset length: 5040
Loaded data/processed/train_agg_5_b.pkl
Train Dataset length: 2772
Loaded data/processed/test_agg_5_b.pkl
Test Dataset length: 1008
Loaded data/processed/train_agg_10_b.pkl
Train Dataset length: 924
Loaded data/processed/test_agg_10_b.pkl
Test Dataset length: 336
For agg 2
train data length: 13860
test data length: 5040
For margin 1
Epoch 1
-------------------------------
loss_prev:  inf
loss:  0.1631176918745041
Epoch 0 loss: 0.1631176918745041
Time elapsed: 22.994513511657715s
Epoch 2
-------------------------------
loss_prev:  0.1631176918745041
loss:  0.15405258536338806
Epoch 1 loss: 0.15405258536338806
Time elapsed: 19.608391284942627s
Epoch 3
-------------------------------
loss_prev:  0.15405258536338806
loss:  0.11131815612316132
Epoch 2 loss: 0.11131815612316132
Time elapsed: 19.660406827926636s
Epoch 4
-------------------------------
loss_prev:  0.11131815612316132
loss:  0.03831413388252258
Epoch 3 loss: 0.03831413388252258
Time elapsed: 19.67763042449951s
Epoch 5
-------------------------------
loss_prev:  0.03831413388252258
loss:  0.07513236999511719
Epoch 4 loss: 0.07513236999511719
Time elapsed: 19.54154133796692s
Epoch 6
-------------------------------
loss_prev:  0.07513236999511719
loss:  0.04825685918331146
Epoch 5 loss: 0.04825685918331146
Time elapsed: 19.483394622802734s
Epoch 7
-------------------------------
loss_prev:  0.04825685918331146
loss:  0.060811229050159454
Epoch 6 loss: 0.060811229050159454
Time elapsed: 19.726489543914795s
Epoch 8
-------------------------------
loss_prev:  0.060811229050159454
loss:  0.01486758142709732
Epoch 7 loss: 0.01486758142709732
Time elapsed: 19.679007053375244s
Epoch 9
-------------------------------
loss_prev:  0.01486758142709732
loss:  0.04939084127545357
Epoch 8 loss: 0.04939084127545357
Time elapsed: 19.621726512908936s
Epoch 10
-------------------------------
loss_prev:  0.04939084127545357
loss:  0.018005678430199623
Epoch 9 loss: 0.018005678430199623
Time elapsed: 19.691131830215454s
Epoch 11
-------------------------------
loss_prev:  0.018005678430199623
loss:  0.04042338579893112
Epoch 10 loss: 0.04042338579893112
Time elapsed: 19.574551343917847s
Epoch 12
-------------------------------
loss_prev:  0.04042338579893112
loss:  0.029811210930347443
Epoch 11 loss: 0.029811210930347443
Time elapsed: 19.542198657989502s
Epoch 13
-------------------------------
loss_prev:  0.029811210930347443
loss:  0.021097930148243904
Epoch 12 loss: 0.021097930148243904
Time elapsed: 19.656036376953125s
Epoch 14
-------------------------------
loss_prev:  0.021097930148243904
loss:  0.01681220903992653
Epoch 13 loss: 0.01681220903992653
Time elapsed: 19.527389526367188s
Epoch 15
-------------------------------
loss_prev:  0.01681220903992653
loss:  0.07055307179689407
Epoch 14 loss: 0.07055307179689407
Time elapsed: 19.68413496017456s
Epoch 16
-------------------------------
loss_prev:  0.07055307179689407
loss:  0.030774183571338654
Epoch 15 loss: 0.030774183571338654
Time elapsed: 19.658380270004272s
Epoch 17
-------------------------------
loss_prev:  0.030774183571338654
loss:  0.0602995902299881
Epoch 16 loss: 0.0602995902299881
Time elapsed: 19.674721002578735s
Epoch 18
-------------------------------
loss_prev:  0.0602995902299881
loss:  0.006860365159809589
Epoch 17 loss: 0.006860365159809589
Time elapsed: 19.564805507659912s
Epoch 19
-------------------------------
loss_prev:  0.006860365159809589
loss:  0.007498406805098057
Loss improvement less than threshold, stop training at epoch 18, batch 866
Training Done
For 2520 samples with label 0
Average score: 0.3995256721973419
Average loss: 0.17077074484966162
True Positive: 2361
False Positive: 452
For 2520 samples with label 1
Average score: 1.7617766857147217
Average loss: 0.1488407765526236
True Negative: 2068
False Negative: 159
--------------
Precision: 0.8393174546747245
Recall: 0.9369047619047619
FPR: 0.17936507936507937
Accuracy: 0.8787698412698413
F-score: 0.8854303393962123
Test Done
plot_roc
Threshold 0.9657609462738037 was selected with Youden's J of 0.7702380952380952
For 2520 samples with label 0
Average score: 0.39952585101127625
Average loss: 0.1675404804980471
True Positive: 2349
False Positive: 408
For 2520 samples with label 1
Average score: 1.7617769241333008
Average loss: 0.15207104087467233
True Negative: 2112
False Negative: 171
--------------
Precision: 0.8520130576713819
Recall: 0.9321428571428572
FPR: 0.1619047619047619
Accuracy: 0.8851190476190476
F-score: 0.8902785673678225
Test Done

For margin 2
Epoch 1
-------------------------------
loss_prev:  inf
loss:  0.10996285080909729
Epoch 0 loss: 0.10996285080909729
Time elapsed: 19.36217427253723s
Epoch 2
-------------------------------
loss_prev:  0.10996285080909729
loss:  3.999999984016789e-11
Epoch 1 loss: 3.999999984016789e-11
Time elapsed: 19.5713791847229s
Epoch 3
-------------------------------
loss_prev:  3.999999984016789e-11
loss:  0.08342188596725464
Epoch 2 loss: 0.08342188596725464
Time elapsed: 19.63709831237793s
Epoch 4
-------------------------------
loss_prev:  0.08342188596725464
loss:  0.039901524782180786
Epoch 3 loss: 0.039901524782180786
Time elapsed: 19.637105464935303s
Epoch 5
-------------------------------
loss_prev:  0.039901524782180786
loss:  0.0
Epoch 4 loss: 0.0
Time elapsed: 19.768592596054077s
Epoch 6
-------------------------------
loss_prev:  0.0
loss:  3.999999984016789e-11
Loss improvement less than threshold, stop training at epoch 5, batch 866
Training Done
For 2520 samples with label 0
Average score: 0.8611498475074768
Average loss: 0.76066744618624
True Positive: 1438
False Positive: 61
For 2520 samples with label 1
Average score: 3.722639322280884
Average loss: 0.6845527715021666
True Negative: 2459
False Negative: 1082
--------------
Precision: 0.9593062041360907
Recall: 0.5706349206349206
FPR: 0.024206349206349207
Accuracy: 0.7732142857142857
F-score: 0.7156008957452102
Test Done
plot_roc
Threshold 2.1661434173583984 was selected with Youden's J of 0.7623015873015873
For 2520 samples with label 0
Average score: 0.8611496686935425
Average loss: 0.757784045236333
True Positive: 2369
False Positive: 448
For 2520 samples with label 1
Average score: 3.7226364612579346
Average loss: 0.6874361669053397
True Negative: 2072
False Negative: 151
--------------
Precision: 0.8409655662051828
Recall: 0.9400793650793651
FPR: 0.17777777777777778
Accuracy: 0.8811507936507936
F-score: 0.887764661795016
Test Done

For margin 5
Epoch 1
-------------------------------
loss_prev:  inf
loss:  0.0
Epoch 0 loss: 0.0
Time elapsed: 19.77851128578186s
Epoch 2
-------------------------------
loss_prev:  0.0
loss:  0.6247860789299011
Epoch 1 loss: 0.6247860789299011
Time elapsed: 19.598716974258423s
Epoch 3
-------------------------------
loss_prev:  0.6247860789299011
loss:  7.999999968033578e-11
Epoch 2 loss: 7.999999968033578e-11
Time elapsed: 19.723482131958008s
Epoch 4
-------------------------------
loss_prev:  7.999999968033578e-11
loss:  0.10681063681840897
Epoch 3 loss: 0.10681063681840897
Time elapsed: 19.550167322158813s
Epoch 5
-------------------------------
loss_prev:  0.10681063681840897
loss:  0.1774509698152542
Epoch 4 loss: 0.1774509698152542
Time elapsed: 19.67908477783203s
Epoch 6
-------------------------------
loss_prev:  0.1774509698152542
loss:  0.5524775981903076
Epoch 5 loss: 0.5524775981903076
Time elapsed: 19.73011088371277s
Epoch 7
-------------------------------
loss_prev:  0.5524775981903076
loss:  0.050401508808135986
Epoch 6 loss: 0.050401508808135986
Time elapsed: 19.7200825214386s
Epoch 8
-------------------------------
loss_prev:  0.050401508808135986
loss:  0.012037193402647972
Epoch 7 loss: 0.012037193402647972
Time elapsed: 19.637423038482666s
Epoch 9
-------------------------------
loss_prev:  0.012037193402647972
loss:  0.04333966225385666
Epoch 8 loss: 0.04333966225385666
Time elapsed: 19.632134437561035s
Epoch 10
-------------------------------
loss_prev:  0.04333966225385666
loss:  0.018745088949799538
Epoch 9 loss: 0.018745088949799538
Time elapsed: 19.49295711517334s
Epoch 11
-------------------------------
loss_prev:  0.018745088949799538
loss:  0.2843598425388336
Epoch 10 loss: 0.2843598425388336
Time elapsed: 19.67286992073059s
Epoch 12
-------------------------------
loss_prev:  0.2843598425388336
loss:  0.006652794778347015
Epoch 11 loss: 0.006652794778347015
Time elapsed: 19.658295392990112s
Epoch 13
-------------------------------
loss_prev:  0.006652794778347015
loss:  0.0
Epoch 12 loss: 0.0
Time elapsed: 19.54638957977295s
Epoch 14
-------------------------------
loss_prev:  0.0
loss:  0.18468192219734192
Epoch 13 loss: 0.18468192219734192
Time elapsed: 19.719261169433594s
Epoch 15
-------------------------------
loss_prev:  0.18468192219734192
loss:  7.999999968033578e-11
Epoch 14 loss: 7.999999968033578e-11
Time elapsed: 19.776938438415527s
Epoch 16
-------------------------------
loss_prev:  7.999999968033578e-11
loss:  0.0
Loss improvement less than threshold, stop training at epoch 15, batch 866
Training Done
For 2520 samples with label 0
Average score: 2.157745599746704
Average loss: 4.819890795828449
True Positive: 908
False Positive: 4
For 2520 samples with label 1
Average score: 9.534034729003906
Average loss: 4.252262373608611
True Negative: 2516
False Negative: 1612
--------------
Precision: 0.9956140350877193
Recall: 0.3603174603174603
FPR: 0.0015873015873015873
Accuracy: 0.6793650793650794
F-score: 0.5291375291375292
Test Done
plot_roc
Threshold 5.030620574951172 was selected with Youden's J of 0.7773809523809523
For 2520 samples with label 0
Average score: 2.157745599746704
Average loss: 4.760155522894292
True Positive: 2318
False Positive: 359
For 2520 samples with label 1
Average score: 9.534034729003906
Average loss: 4.311997662579256
True Negative: 2161
False Negative: 202
--------------
Precision: 0.865894658199477
Recall: 0.9198412698412698
FPR: 0.14246031746031745
Accuracy: 0.8886904761904761
F-score: 0.8920531075620549
Test Done

For margin 10
Epoch 1
-------------------------------
loss_prev:  inf
loss:  0.8005985617637634
Epoch 0 loss: 0.8005985617637634
Time elapsed: 19.56558394432068s
Epoch 2
-------------------------------
loss_prev:  0.8005985617637634
loss:  1.3705195188522339
Epoch 1 loss: 1.3705195188522339
Time elapsed: 19.66396975517273s
Epoch 3
-------------------------------
loss_prev:  1.3705195188522339
loss:  0.28211909532546997
Epoch 2 loss: 0.28211909532546997
Time elapsed: 19.600860118865967s
Epoch 4
-------------------------------
loss_prev:  0.28211909532546997
loss:  3.999999984016789e-11
Epoch 3 loss: 3.999999984016789e-11
Time elapsed: 19.532064199447632s
Epoch 5
-------------------------------
loss_prev:  3.999999984016789e-11
loss:  0.3997741639614105
Epoch 4 loss: 0.3997741639614105
Time elapsed: 19.66677165031433s
Epoch 6
-------------------------------
loss_prev:  0.3997741639614105
loss:  2.144380569458008
Epoch 5 loss: 2.144380569458008
Time elapsed: 19.57854723930359s
Epoch 7
-------------------------------
loss_prev:  2.144380569458008
loss:  3.999999984016789e-11
Epoch 6 loss: 3.999999984016789e-11
Time elapsed: 19.637009859085083s
Epoch 8
-------------------------------
loss_prev:  3.999999984016789e-11
loss:  0.8545235395431519
Epoch 7 loss: 0.8545235395431519
Time elapsed: 19.29458212852478s
Epoch 9
-------------------------------
loss_prev:  0.8545235395431519
loss:  0.5336915254592896
Epoch 8 loss: 0.5336915254592896
Time elapsed: 19.670718669891357s
Epoch 10
-------------------------------
loss_prev:  0.5336915254592896
loss:  3.999999984016789e-11
Epoch 9 loss: 3.999999984016789e-11
Time elapsed: 19.6270010471344s
Epoch 11
-------------------------------
loss_prev:  3.999999984016789e-11
loss:  0.2697744369506836
Epoch 10 loss: 0.2697744369506836
Time elapsed: 19.710163593292236s
Epoch 12
-------------------------------
loss_prev:  0.2697744369506836
loss:  0.0
Epoch 11 loss: 0.0
Time elapsed: 19.72125005722046s
Epoch 13
-------------------------------
loss_prev:  0.0
loss:  3.999999984016789e-11
Loss improvement less than threshold, stop training at epoch 12, batch 866
Training Done
For 2520 samples with label 0
Average score: 4.283421516418457
Average loss: 18.67740853074051
True Positive: 848
False Positive: 1
For 2520 samples with label 1
Average score: 18.797412872314453
Average loss: 16.78557427899232
True Negative: 2520
False Negative: 1672
--------------
Precision: 0.9988221436984688
Recall: 0.33650793650793653
FPR: 0.0003966679888932963
Accuracy: 0.6681214044832374
F-score: 0.5034134758088453
Test Done
plot_roc
Threshold 10.554372787475586 was selected with Youden's J of 0.786111111111111
For 2520 samples with label 0
Average score: 4.283421993255615
Average loss: 18.71352785910879
True Positive: 2369
False Positive: 388
For 2520 samples with label 1
Average score: 18.797393798828125
Average loss: 16.7494550785375
True Negative: 2132
False Negative: 151
--------------
Precision: 0.8592673195502357
Recall: 0.9400793650793651
FPR: 0.15396825396825398
Accuracy: 0.8930555555555556
F-score: 0.8978586317983702
Test Done

For margin 20
Epoch 1
-------------------------------
loss_prev:  inf
loss:  0.06886523962020874
Epoch 0 loss: 0.06886523962020874
Time elapsed: 19.65772557258606s
Epoch 2
-------------------------------
loss_prev:  0.06886523962020874
loss:  0.5328031182289124
Epoch 1 loss: 0.5328031182289124
Time elapsed: 19.170595407485962s
Epoch 3
-------------------------------
loss_prev:  0.5328031182289124
loss:  3.999999984016789e-11
Epoch 2 loss: 3.999999984016789e-11
Time elapsed: 19.718440532684326s
Epoch 4
-------------------------------
loss_prev:  3.999999984016789e-11
loss:  7.999999968033578e-11
Loss improvement less than threshold, stop training at epoch 3, batch 866
Training Done
For 2520 samples with label 0
Average score: 9.055442810058594
Average loss: 82.93427670210127
True Positive: 840
False Positive: 1
For 2520 samples with label 1
Average score: 39.6095085144043
Average loss: 73.6644733760092
True Negative: 2520
False Negative: 1680
--------------
Precision: 0.9988109393579072
Recall: 0.3333333333333333
FPR: 0.0003966679888932963
Accuracy: 0.6665344177742512
F-score: 0.499851234751562
Test Done
plot_roc
Threshold 22.50871467590332 was selected with Youden's J of 0.7805555555555554
For 2520 samples with label 0
Average score: 9.055445671081543
Average loss: 83.93614055050745
True Positive: 2370
False Positive: 403
For 2520 samples with label 1
Average score: 39.60952377319336
Average loss: 72.66260904016949
True Negative: 2117
False Negative: 150
--------------
Precision: 0.8546700324558241
Recall: 0.9404761904761905
FPR: 0.1599206349206349
Accuracy: 0.8902777777777777
F-score: 0.8955223880597015
Test Done

For margin 30
Epoch 1
-------------------------------
loss_prev:  inf
loss:  0.5425410866737366
Epoch 0 loss: 0.5425410866737366
Time elapsed: 19.57976269721985s
Epoch 2
-------------------------------
loss_prev:  0.5425410866737366
loss:  0.18167126178741455
Epoch 1 loss: 0.18167126178741455
Time elapsed: 19.63846778869629s
Epoch 3
-------------------------------
loss_prev:  0.18167126178741455
loss:  1.2520954608917236
Epoch 2 loss: 1.2520954608917236
Time elapsed: 19.445733070373535s
Epoch 4
-------------------------------
loss_prev:  1.2520954608917236
loss:  4.945560932159424
Epoch 3 loss: 4.945560932159424
Time elapsed: 19.36665964126587s
Epoch 5
-------------------------------
loss_prev:  4.945560932159424
loss:  1.1691194772720337
Epoch 4 loss: 1.1691194772720337
Time elapsed: 19.68446135520935s
Epoch 6
-------------------------------
loss_prev:  1.1691194772720337
loss:  1.2341055870056152
Epoch 5 loss: 1.2341055870056152
Time elapsed: 19.65796208381653s
Epoch 7
-------------------------------
loss_prev:  1.2341055870056152
loss:  2.142519950866699
Epoch 6 loss: 2.142519950866699
Time elapsed: 19.76544213294983s
Epoch 8
-------------------------------
loss_prev:  2.142519950866699
loss:  3.2841992378234863
Epoch 7 loss: 3.2841992378234863
Time elapsed: 19.72710609436035s
Epoch 9
-------------------------------
loss_prev:  3.2841992378234863
loss:  10.408222198486328
Epoch 8 loss: 10.408222198486328
Time elapsed: 19.742136001586914s
Epoch 10
-------------------------------
loss_prev:  10.408222198486328
loss:  1.9169179201126099
Epoch 9 loss: 1.9169179201126099
Time elapsed: 19.749098777770996s
Epoch 11
-------------------------------
loss_prev:  1.9169179201126099
loss:  1.5012855529785156
Epoch 10 loss: 1.5012855529785156
Time elapsed: 19.737735986709595s
Epoch 12
-------------------------------
loss_prev:  1.5012855529785156
loss:  7.999999968033578e-11
Epoch 11 loss: 7.999999968033578e-11
Time elapsed: 19.663393259048462s
Epoch 13
-------------------------------
loss_prev:  7.999999968033578e-11
loss:  1.2345396280288696
Epoch 12 loss: 1.2345396280288696
Time elapsed: 19.660821676254272s
Epoch 14
-------------------------------
loss_prev:  1.2345396280288696
loss:  3.795088529586792
Epoch 13 loss: 3.795088529586792
Time elapsed: 19.60701823234558s
Epoch 15
-------------------------------
loss_prev:  3.795088529586792
loss:  2.808264970779419
Epoch 14 loss: 2.808264970779419
Time elapsed: 19.740629196166992s
Epoch 16
-------------------------------
loss_prev:  2.808264970779419
loss:  1.13901948928833
Epoch 15 loss: 1.13901948928833
Time elapsed: 19.67509913444519s
Epoch 17
-------------------------------
loss_prev:  1.13901948928833
loss:  2.3802664279937744
Epoch 16 loss: 2.3802664279937744
Time elapsed: 19.57312798500061s
Epoch 18
-------------------------------
loss_prev:  2.3802664279937744
loss:  0.6822538375854492
Epoch 17 loss: 0.6822538375854492
Time elapsed: 19.664891242980957s
Epoch 19
-------------------------------
loss_prev:  0.6822538375854492
loss:  7.999999968033578e-11
Epoch 18 loss: 7.999999968033578e-11
Time elapsed: 19.811217546463013s
Epoch 20
-------------------------------
loss_prev:  7.999999968033578e-11
loss:  0.3486633598804474
Epoch 19 loss: 0.3486633598804474
Time elapsed: 19.22579026222229s
Epoch 21
-------------------------------
loss_prev:  0.3486633598804474
loss:  0.7363767027854919
Epoch 20 loss: 0.7363767027854919
Time elapsed: 19.730714321136475s
Epoch 22
-------------------------------
loss_prev:  0.7363767027854919
loss:  0.2664376497268677
Epoch 21 loss: 0.2664376497268677
Time elapsed: 19.689009428024292s
Epoch 23
-------------------------------
loss_prev:  0.2664376497268677
loss:  1.0213489532470703
Epoch 22 loss: 1.0213489532470703
Time elapsed: 19.743544340133667s
Epoch 24
-------------------------------
loss_prev:  1.0213489532470703
loss:  0.3036908507347107
Epoch 23 loss: 0.3036908507347107
Time elapsed: 19.574182510375977s
Epoch 25
-------------------------------
loss_prev:  0.3036908507347107
loss:  3.999999984016789e-11
Epoch 24 loss: 3.999999984016789e-11
Time elapsed: 19.635813236236572s
Epoch 26
-------------------------------
loss_prev:  3.999999984016789e-11
loss:  0.0375383086502552
Epoch 25 loss: 0.0375383086502552
Time elapsed: 19.63878846168518s
Epoch 27
-------------------------------
loss_prev:  0.0375383086502552
loss:  2.3041465282440186
Epoch 26 loss: 2.3041465282440186
Time elapsed: 19.715786933898926s
Epoch 28
-------------------------------
loss_prev:  2.3041465282440186
loss:  0.6932318806648254
Epoch 27 loss: 0.6932318806648254
Time elapsed: 19.717414617538452s
Epoch 29
-------------------------------
loss_prev:  0.6932318806648254
loss:  1.2012465000152588
Epoch 28 loss: 1.2012465000152588
Time elapsed: 19.549538373947144s
Epoch 30
-------------------------------
loss_prev:  1.2012465000152588
loss:  1.2761987447738647
Epoch 29 loss: 1.2761987447738647
Time elapsed: 19.643581867218018s
Epoch 31
-------------------------------
loss_prev:  1.2761987447738647
loss:  1.1984148025512695
Epoch 30 loss: 1.1984148025512695
Time elapsed: 19.6424458026886s
Epoch 32
-------------------------------
loss_prev:  1.1984148025512695
loss:  2.33817982673645
Epoch 31 loss: 2.33817982673645
Time elapsed: 19.71541738510132s
Epoch 33
-------------------------------
loss_prev:  2.33817982673645
loss:  3.6195080280303955
Epoch 32 loss: 3.6195080280303955
Time elapsed: 19.770841598510742s
Epoch 34
-------------------------------
loss_prev:  3.6195080280303955
loss:  0.05173061415553093
Epoch 33 loss: 0.05173061415553093
Time elapsed: 19.73781991004944s
Epoch 35
-------------------------------
loss_prev:  0.05173061415553093
loss:  0.2878425717353821
Epoch 34 loss: 0.2878425717353821
Time elapsed: 19.39099359512329s
Epoch 36
-------------------------------
loss_prev:  0.2878425717353821
loss:  1.9680695533752441
Epoch 35 loss: 1.9680695533752441
Time elapsed: 19.734786987304688s
Epoch 37
-------------------------------
loss_prev:  1.9680695533752441
loss:  1.0184673070907593
Epoch 36 loss: 1.0184673070907593
Time elapsed: 19.786102294921875s
Epoch 38
-------------------------------
loss_prev:  1.0184673070907593
loss:  0.26481297612190247
Epoch 37 loss: 0.26481297612190247
Time elapsed: 19.591378927230835s
Epoch 39
-------------------------------
loss_prev:  0.26481297612190247
loss:  3.4257068634033203
Epoch 38 loss: 3.4257068634033203
Time elapsed: 19.683300495147705s
Epoch 40
-------------------------------
loss_prev:  3.4257068634033203
loss:  0.49027663469314575
Epoch 39 loss: 0.49027663469314575
Time elapsed: 19.754119396209717s
Epoch 41
-------------------------------
loss_prev:  0.49027663469314575
loss:  3.999999984016789e-11
Epoch 40 loss: 3.999999984016789e-11
Time elapsed: 19.647112607955933s
Epoch 42
-------------------------------
loss_prev:  3.999999984016789e-11
loss:  0.0
Loss improvement less than threshold, stop training at epoch 41, batch 866
Training Done
For 2520 samples with label 0
Average score: 12.544713973999023
Average loss: 161.56576832286896
True Positive: 840
False Positive: 1
For 2520 samples with label 1
Average score: 56.1023063659668
Average loss: 145.75472317725894
True Negative: 2520
False Negative: 1680
--------------
Precision: 0.9988109393579072
Recall: 0.3333333333333333
FPR: 0.0003966679888932963
Accuracy: 0.6665344177742512
F-score: 0.499851234751562
Test Done
plot_roc
Threshold 31.196950912475586 was selected with Youden's J of 0.786111111111111
For 2520 samples with label 0
Average score: 12.544711112976074
Average loss: 161.64849440786574
True Positive: 2372
False Positive: 391
For 2520 samples with label 1
Average score: 56.102394104003906
Average loss: 145.67199654730538
True Negative: 2129
False Negative: 148
--------------
Precision: 0.8584871516467608
Recall: 0.9412698412698413
FPR: 0.15515873015873016
Accuracy: 0.8930555555555556
F-score: 0.8979746356236987
Test Done

For agg 5
train data length: 2772
test data length: 1008
For margin 1
Epoch 1
-------------------------------
loss_prev:  inf
loss:  0.026086732745170593
Epoch 0 loss: 0.026086732745170593
Time elapsed: 4.494346380233765s
Epoch 2
-------------------------------
loss_prev:  0.026086732745170593
loss:  0.007918854244053364
Epoch 1 loss: 0.007918854244053364
Time elapsed: 4.341970682144165s
Epoch 3
-------------------------------
loss_prev:  0.007918854244053364
loss:  0.014135857112705708
Epoch 2 loss: 0.014135857112705708
Time elapsed: 4.374326705932617s
Epoch 4
-------------------------------
loss_prev:  0.014135857112705708
loss:  0.03222620487213135
Epoch 3 loss: 0.03222620487213135
Time elapsed: 4.421675443649292s
Epoch 5
-------------------------------
loss_prev:  0.03222620487213135
loss:  0.03242470324039459
Loss improvement less than threshold, stop training at epoch 4, batch 173
Training Done
For 504 samples with label 0
Average score: 0.1630941927433014
Average loss: 0.07128477126933984
True Positive: 497
False Positive: 142
For 504 samples with label 1
Average score: 1.4598193168640137
Average loss: 0.06727571601521945
True Negative: 362
False Negative: 7
--------------
Precision: 0.7777777777777778
Recall: 0.9861111111111112
FPR: 0.28174603174603174
Accuracy: 0.8521825396825397
F-score: 0.8696412948381453
Test Done
plot_roc
Threshold 0.6099570989608765 was selected with Youden's J of 0.8392857142857144
For 504 samples with label 0
Average score: 0.1630941480398178
Average loss: 0.07297525052270147
True Positive: 468
False Positive: 45
For 504 samples with label 1
Average score: 1.4598194360733032
Average loss: 0.0655852370818555
True Negative: 459
False Negative: 36
--------------
Precision: 0.9122807017543859
Recall: 0.9285714285714286
FPR: 0.08928571428571429
Accuracy: 0.9196428571428571
F-score: 0.9203539823008849
Test Done

For margin 2
Epoch 1
-------------------------------
loss_prev:  inf
loss:  3.999999984016789e-11
Epoch 0 loss: 3.999999984016789e-11
Time elapsed: 4.4287168979644775s
Epoch 2
-------------------------------
loss_prev:  3.999999984016789e-11
loss:  7.999999968033578e-11
Loss improvement less than threshold, stop training at epoch 1, batch 173
Training Done
For 504 samples with label 0
Average score: 0.2931843101978302
Average loss: 0.24593702433094944
True Positive: 446
False Positive: 27
For 504 samples with label 1
Average score: 2.890428066253662
Average loss: 0.2260668915779596
True Negative: 477
False Negative: 58
--------------
Precision: 0.9429175475687104
Recall: 0.8849206349206349
FPR: 0.05357142857142857
Accuracy: 0.9156746031746031
F-score: 0.9129989764585467
Test Done
plot_roc
Threshold 1.1338188648223877 was selected with Youden's J of 0.8452380952380953
For 504 samples with label 0
Average score: 0.29318463802337646
Average loss: 0.24208918040884392
True Positive: 460
False Positive: 34
For 504 samples with label 1
Average score: 2.890428066253662
Average loss: 0.22991473448004515
True Negative: 470
False Negative: 44
--------------
Precision: 0.9311740890688259
Recall: 0.9126984126984127
FPR: 0.06746031746031746
Accuracy: 0.9226190476190477
F-score: 0.9218436873747495
Test Done

For margin 5
Epoch 1
-------------------------------
loss_prev:  inf
loss:  3.999999984016789e-11
Epoch 0 loss: 3.999999984016789e-11
Time elapsed: 4.38561487197876s
Epoch 2
-------------------------------
loss_prev:  3.999999984016789e-11
loss:  1.199999960510567e-10
Loss improvement less than threshold, stop training at epoch 1, batch 173
Training Done
For 504 samples with label 0
Average score: 0.7085087895393372
Average loss: 1.3236568915169864
True Positive: 357
False Positive: 1
For 504 samples with label 1
Average score: 7.929941654205322
Average loss: 1.2543167329082887
True Negative: 504
False Negative: 147
--------------
Precision: 0.9972067039106145
Recall: 0.7083333333333334
FPR: 0.0019801980198019802
Accuracy: 0.8533201189296333
F-score: 0.8283062645011601
Test Done
plot_roc
Threshold 3.2004382610321045 was selected with Youden's J of 0.873015873015873
For 504 samples with label 0
Average score: 0.7085096836090088
Average loss: 1.3248803421631146
True Positive: 480
False Positive: 40
For 504 samples with label 1
Average score: 7.929944038391113
Average loss: 1.253093299412862
True Negative: 464
False Negative: 24
--------------
Precision: 0.9230769230769231
Recall: 0.9523809523809523
FPR: 0.07936507936507936
Accuracy: 0.9365079365079365
F-score: 0.9375
Test Done

For margin 10
Epoch 1
-------------------------------
loss_prev:  inf
loss:  8.782861709594727
Epoch 0 loss: 8.782861709594727
Time elapsed: 4.466481924057007s
Epoch 2
-------------------------------
loss_prev:  8.782861709594727
loss:  0.7074853181838989
Epoch 1 loss: 0.7074853181838989
Time elapsed: 4.284094333648682s
Epoch 3
-------------------------------
loss_prev:  0.7074853181838989
loss:  0.37086570262908936
Epoch 2 loss: 0.37086570262908936
Time elapsed: 4.4161975383758545s
Epoch 4
-------------------------------
loss_prev:  0.37086570262908936
loss:  7.999999968033578e-11
Epoch 3 loss: 7.999999968033578e-11
Time elapsed: 4.436419486999512s
Epoch 5
-------------------------------
loss_prev:  7.999999968033578e-11
loss:  1.199999960510567e-10
Loss improvement less than threshold, stop training at epoch 4, batch 173
Training Done
For 504 samples with label 0
Average score: 1.6005319356918335
Average loss: 6.214727605796702
True Positive: 338
False Positive: 1
For 504 samples with label 1
Average score: 18.984209060668945
Average loss: 5.305303014283443
True Negative: 504
False Negative: 166
--------------
Precision: 0.9970501474926253
Recall: 0.6706349206349206
FPR: 0.0019801980198019802
Accuracy: 0.8344895936570862
F-score: 0.8018979833926453
Test Done
plot_roc
Threshold 7.637452125549316 was selected with Youden's J of 0.876984126984127
For 504 samples with label 0
Average score: 1.6005315780639648
Average loss: 6.018446187179882
True Positive: 484
False Positive: 42
For 504 samples with label 1
Average score: 18.984193801879883
Average loss: 5.501584428645646
True Negative: 462
False Negative: 20
--------------
Precision: 0.9201520912547528
Recall: 0.9603174603174603
FPR: 0.08333333333333333
Accuracy: 0.9384920634920635
F-score: 0.9398058252427185
Test Done

For margin 20
Epoch 1
-------------------------------
loss_prev:  inf
loss:  1.2890485525131226
Epoch 0 loss: 1.2890485525131226
Time elapsed: 4.533880710601807s
Epoch 2
-------------------------------
loss_prev:  1.2890485525131226
loss:  1.3703093528747559
Epoch 1 loss: 1.3703093528747559
Time elapsed: 4.49342155456543s
Epoch 3
-------------------------------
loss_prev:  1.3703093528747559
loss:  2.1185028553009033
Epoch 2 loss: 2.1185028553009033
Time elapsed: 4.555705308914185s
Epoch 4
-------------------------------
loss_prev:  2.1185028553009033
loss:  3.999999984016789e-11
Epoch 3 loss: 3.999999984016789e-11
Time elapsed: 4.709711790084839s
Epoch 5
-------------------------------
loss_prev:  3.999999984016789e-11
loss:  7.999999968033578e-11
Loss improvement less than threshold, stop training at epoch 4, batch 173
Training Done
For 504 samples with label 0
Average score: 2.9815304279327393
Average loss: 20.878021089330552
True Positive: 336
False Positive: 1
For 504 samples with label 1
Average score: 36.49967956542969
Average loss: 19.14222278623354
True Negative: 504
False Negative: 168
--------------
Precision: 0.9970326409495549
Recall: 0.6666666666666666
FPR: 0.0019801980198019802
Accuracy: 0.8325074331020813
F-score: 0.7990487514863257
Test Done
plot_roc
Threshold 14.084712028503418 was selected with Youden's J of 0.8928571428571428
For 504 samples with label 0
Average score: 2.9815313816070557
Average loss: 20.73946371438109
True Positive: 485
False Positive: 35
For 504 samples with label 1
Average score: 36.49968338012695
Average loss: 19.28078008549679
True Negative: 469
False Negative: 19
--------------
Precision: 0.9326923076923077
Recall: 0.9623015873015873
FPR: 0.06944444444444445
Accuracy: 0.9464285714285714
F-score: 0.9472656250000001
Test Done

For margin 30
Epoch 1
-------------------------------
loss_prev:  inf
loss:  1.199999960510567e-10
Epoch 0 loss: 1.199999960510567e-10
Time elapsed: 4.500641345977783s
Epoch 2
-------------------------------
loss_prev:  1.199999960510567e-10
loss:  17.030086517333984
Epoch 1 loss: 17.030086517333984
Time elapsed: 4.4008519649505615s
Epoch 3
-------------------------------
loss_prev:  17.030086517333984
loss:  0.1604728102684021
Epoch 2 loss: 0.1604728102684021
Time elapsed: 4.489500522613525s
Epoch 4
-------------------------------
loss_prev:  0.1604728102684021
loss:  1.199999960510567e-10
Epoch 3 loss: 1.199999960510567e-10
Time elapsed: 4.441139221191406s
Epoch 5
-------------------------------
loss_prev:  1.199999960510567e-10
loss:  5.271074295043945
Epoch 4 loss: 5.271074295043945
Time elapsed: 4.374995946884155s
Epoch 6
-------------------------------
loss_prev:  5.271074295043945
loss:  0.09539142996072769
Epoch 5 loss: 0.09539142996072769
Time elapsed: 4.371995449066162s
Epoch 7
-------------------------------
loss_prev:  0.09539142996072769
loss:  0.7796593308448792
Epoch 6 loss: 0.7796593308448792
Time elapsed: 4.8290088176727295s
Epoch 8
-------------------------------
loss_prev:  0.7796593308448792
loss:  0.08434974402189255
Epoch 7 loss: 0.08434974402189255
Time elapsed: 4.897337913513184s
Epoch 9
-------------------------------
loss_prev:  0.08434974402189255
loss:  1.199999960510567e-10
Epoch 8 loss: 1.199999960510567e-10
Time elapsed: 4.93983268737793s
Epoch 10
-------------------------------
loss_prev:  1.199999960510567e-10
loss:  1.199999960510567e-10
Loss improvement less than threshold, stop training at epoch 9, batch 173
Training Done
For 504 samples with label 0
Average score: 4.256399631500244
Average loss: 43.43253819054371
True Positive: 336
False Positive: 1
For 504 samples with label 1
Average score: 52.61479568481445
Average loss: 40.88783237662308
True Negative: 504
False Negative: 168
--------------
Precision: 0.9970326409495549
Recall: 0.6666666666666666
FPR: 0.0019801980198019802
Accuracy: 0.8325074331020813
F-score: 0.7990487514863257
Test Done
plot_roc
Threshold 20.80701446533203 was selected with Youden's J of 0.8948412698412698
For 504 samples with label 0
Average score: 4.256400108337402
Average loss: 42.43881930150683
True Positive: 489
False Positive: 38
For 504 samples with label 1
Average score: 52.61478042602539
Average loss: 41.88155166781138
True Negative: 466
False Negative: 15
--------------
Precision: 0.9278937381404174
Recall: 0.9702380952380952
FPR: 0.07539682539682539
Accuracy: 0.9474206349206349
F-score: 0.9485935984481085
Test Done

For agg 10
train data length: 924
test data length: 336
For margin 1
Epoch 1
-------------------------------
loss_prev:  inf
loss:  7.999999968033578e-11
Epoch 0 loss: 7.999999968033578e-11
Time elapsed: 1.916139841079712s
Epoch 2
-------------------------------
loss_prev:  7.999999968033578e-11
loss:  7.999999968033578e-11
Loss improvement less than threshold, stop training at epoch 1, batch 57
Training Done
For 168 samples with label 0
Average score: 1.2649116797547322e-05
Average loss: 8.333332955155429e-11
True Positive: 168
False Positive: 1
For 168 samples with label 1
Average score: 54.77080535888672
Average loss: 7.66666635310704e-11
True Negative: 168
False Negative: 1
--------------
Precision: 0.9940828402366864
Recall: 0.9940828402366864
FPR: 0.005917159763313609
Accuracy: 0.9940828402366864
F-score: 0.9940828402366864
Test Done
plot_roc
Threshold 6.716784477233887 was selected with Youden's J of 1.0
For 168 samples with label 0
Average score: 1.2649116797547322e-05
Average loss: 8.34523766641652e-11
True Positive: 168
False Positive: 1
For 168 samples with label 1
Average score: 54.77080535888672
Average loss: 7.654761542718893e-11
True Negative: 168
False Negative: 1
--------------
Precision: 0.9940828402366864
Recall: 0.9940828402366864
FPR: 0.005917159763313609
Accuracy: 0.9940828402366864
F-score: 0.9940828402366864
Test Done

For margin 2
Epoch 1
-------------------------------
loss_prev:  inf
loss:  6.66666652437975e-11
Epoch 0 loss: 6.66666652437975e-11
Time elapsed: 1.9009196758270264s
Epoch 2
-------------------------------
loss_prev:  6.66666652437975e-11
loss:  7.999999968033578e-11
Loss improvement less than threshold, stop training at epoch 1, batch 57
Training Done
For 168 samples with label 0
Average score: 1.2649116797547322e-05
Average loss: 8.35714253669393e-11
True Positive: 168
False Positive: 1
For 168 samples with label 1
Average score: 54.77079772949219
Average loss: 7.642856870695595e-11
True Negative: 168
False Negative: 1
--------------
Precision: 0.9940828402366864
Recall: 0.9940828402366864
FPR: 0.005917159763313609
Accuracy: 0.9940828402366864
F-score: 0.9940828402366864
Test Done
plot_roc
Threshold 6.716794013977051 was selected with Youden's J of 1.0
For 168 samples with label 0
Average score: 1.2649116797547322e-05
Average loss: 8.51190439437163e-11
True Positive: 168
False Positive: 1
For 168 samples with label 1
Average score: 54.77079772949219
Average loss: 7.488094946933192e-11
True Negative: 168
False Negative: 1
--------------
Precision: 0.9940828402366864
Recall: 0.9940828402366864
FPR: 0.005917159763313609
Accuracy: 0.9940828402366864
F-score: 0.9940828402366864
Test Done

For margin 5
Epoch 1
-------------------------------
loss_prev:  inf
loss:  9.333333411687406e-11
Epoch 0 loss: 9.333333411687406e-11
Time elapsed: 1.8811266422271729s
Epoch 2
-------------------------------
loss_prev:  9.333333411687406e-11
loss:  1.0666666161451843e-10
Loss improvement less than threshold, stop training at epoch 1, batch 57
Training Done
For 168 samples with label 0
Average score: 1.2649116797547322e-05
Average loss: 8.488094856201215e-11
True Positive: 168
False Positive: 1
For 168 samples with label 1
Average score: 54.819766998291016
Average loss: 7.511904452061254e-11
True Negative: 168
False Negative: 1
--------------
Precision: 0.9940828402366864
Recall: 0.9940828402366864
FPR: 0.005917159763313609
Accuracy: 0.9940828402366864
F-score: 0.9940828402366864
Test Done
plot_roc
Threshold 6.616393566131592 was selected with Youden's J of 1.0
For 168 samples with label 0
Average score: 1.2649116797547322e-05
Average loss: 8.464285272597566e-11
True Positive: 168
False Positive: 1
For 168 samples with label 1
Average score: 54.81976318359375
Average loss: 7.535713903495494e-11
True Negative: 168
False Negative: 1
--------------
Precision: 0.9940828402366864
Recall: 0.9940828402366864
FPR: 0.005917159763313609
Accuracy: 0.9940828402366864
F-score: 0.9940828402366864
Test Done

For margin 10
Epoch 1
-------------------------------
loss_prev:  inf
loss:  9.333333411687406e-11
Epoch 0 loss: 9.333333411687406e-11
Time elapsed: 1.8378674983978271s
Epoch 2
-------------------------------
loss_prev:  9.333333411687406e-11
loss:  6.66666652437975e-11
Loss improvement less than threshold, stop training at epoch 1, batch 57
Training Done
For 168 samples with label 0
Average score: 1.2649116797547322e-05
Average loss: 0.043620264682449325
True Positive: 168
False Positive: 1
For 168 samples with label 1
Average score: 57.029518127441406
Average loss: 0.08198919579726666
True Negative: 168
False Negative: 1
--------------
Precision: 0.9940828402366864
Recall: 0.9940828402366864
FPR: 0.005917159763313609
Accuracy: 0.9940828402366864
F-score: 0.9940828402366864
Test Done
plot_roc
Threshold 6.097087383270264 was selected with Youden's J of 1.0
For 168 samples with label 0
Average score: 1.2649116797547322e-05
Average loss: 0.047103547704536446
True Positive: 168
False Positive: 1
For 168 samples with label 1
Average score: 57.0295295715332
Average loss: 0.07850591277517978
True Negative: 168
False Negative: 1
--------------
Precision: 0.9940828402366864
Recall: 0.9940828402366864
FPR: 0.005917159763313609
Accuracy: 0.9940828402366864
F-score: 0.9940828402366864
Test Done

For margin 20
Epoch 1
-------------------------------
loss_prev:  inf
loss:  7.999999968033578e-11
Epoch 0 loss: 7.999999968033578e-11
Time elapsed: 1.8083693981170654s
Epoch 2
-------------------------------
loss_prev:  7.999999968033578e-11
loss:  5.333333427670617e-11
Loss improvement less than threshold, stop training at epoch 1, batch 57
Training Done
For 168 samples with label 0
Average score: 1.2649116797547322e-05
Average loss: 0.09632253229299514
True Positive: 168
False Positive: 1
For 168 samples with label 1
Average score: 84.98323822021484
Average loss: 0.2119095709375427
True Negative: 168
False Negative: 1
--------------
Precision: 0.9940828402366864
Recall: 0.9940828402366864
FPR: 0.005917159763313609
Accuracy: 0.9940828402366864
F-score: 0.9940828402366864
Test Done
plot_roc
Threshold 12.803959846496582 was selected with Youden's J of 1.0
For 168 samples with label 0
Average score: 1.2649116797547322e-05
Average loss: 0.1733805580595584
True Positive: 168
False Positive: 1
For 168 samples with label 1
Average score: 84.98323059082031
Average loss: 0.13485154516716977
True Negative: 168
False Negative: 1
--------------
Precision: 0.9940828402366864
Recall: 0.9940828402366864
FPR: 0.005917159763313609
Accuracy: 0.9940828402366864
F-score: 0.9940828402366864
Test Done

For margin 30
Epoch 1
-------------------------------
loss_prev:  inf
loss:  7.999999968033578e-11
Epoch 0 loss: 7.999999968033578e-11
Time elapsed: 1.8650825023651123s
Epoch 2
-------------------------------
loss_prev:  7.999999968033578e-11
loss:  9.333333411687406e-11
Loss improvement less than threshold, stop training at epoch 1, batch 57
Training Done
For 168 samples with label 0
Average score: 1.2649116797547322e-05
Average loss: 3.2278626419922434
True Positive: 168
False Positive: 1
For 168 samples with label 1
Average score: 110.8442153930664
Average loss: 4.3472609407057545
True Negative: 168
False Negative: 1
--------------
Precision: 0.9940828402366864
Recall: 0.9940828402366864
FPR: 0.005917159763313609
Accuracy: 0.9940828402366864
F-score: 0.9940828402366864
Test Done
plot_roc
Threshold 1.3605291843414307 was selected with Youden's J of 1.0
For 168 samples with label 0
Average score: 1.2649116797547322e-05
Average loss: 2.585501574411783
True Positive: 168
False Positive: 1
For 168 samples with label 1
Average score: 110.84420776367188
Average loss: 4.989622008290949
True Negative: 168
False Negative: 1
--------------
Precision: 0.9940828402366864
Recall: 0.9940828402366864
FPR: 0.005917159763313609
Accuracy: 0.9940828402366864
F-score: 0.9940828402366864
Test Done

